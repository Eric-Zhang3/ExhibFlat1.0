/* Dialog component for jQuery ( AMD Module ) | MIT Licenses | 2014-03-19 */
define(["../../drag/js/drag.min"],function(){$.easing.easeIn=function(a){return a*a};$.easing.easeOut=function(a){return(2-a)*a};$.easing.easeInStrong=function(a){return a*a*a*a};$.easing.easeOutStrong=function(a){return 1- --a*a*a*a};var A={autoClose:null,content:"Hello world : )",title:null,yesText:"\u786e\u5b9a",noText:"\u53d6\u6d88",yesFn:null,noFn:null,width:"320px",height:"auto",top:null,left:null,trigger:"click",overlay:!0,overlayClose:!1,fixed:!0,lock:!1,effects:null,zIndex:9999,drag:!0,topWindow:!1,
elem:null,dragHandle:null},n=$.browser.msie&&"6.0"===$.browser.version,c,e,p,s,u,h,v,w,x,q,l,m,y,t,f={capitalize:function(a){var b=a.charAt(0);return b.toUpperCase()+a.replace(b,"")},getDocSize:function(a){a=f.capitalize(a);return Math.max(l["scroll"+a],l["client"+a])},appendIframe:function(a){var b;a.children("iframe.ecope_bg_iframe").length||(b=$('<iframe class="ecope_bg_iframe" frameborder="0" tabindex="-1" src="javascript:false;" style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;border:0 none;filter:alpha(opacity=0)"/>',
q),a.prepend(b))},createOverlay:function(a){c||(c=$('<div class="ecope_overlay" style="margin:0;padding:0;display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:'+a+'"/>',q).appendTo(t),n&&(c.css("position","absolute"),f.appendIframe(c),c.append('<div style="position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;" />')))},createDialogBox:function(a,b){e||(e=$('<div class="ecope_dialog" style="padding:0;display:none;z-index:'+a+'"/>',q),n&&!b&&f.appendIframe(e),t.append(e))},
createDialogContent:function(a){var b=e.children().last(),d,k,g,c;if(a.elem)b.length&&(b.hide(),t.append(b)),h&&(h.remove(),h=null),e.append(a.elem),a.elem.show();else{d=$.isFunction(a.yesFn);k=$.isFunction(a.noFn)||!0===a.noFn;g=d||k;c=function(b){f.close(a);b&&b.preventDefault()};h?(b=h.find("div.dg_header"),p=h.find("a.dg_btn_yes"),s=h.find("a.dg_btn_no"),h.find("div.dg_content").html(a.content),a.title?b.html(a.title).show():b.hide(),d?(p.text(a.yesText).show(),g=!0):p.hide(),k?(s.text(a.noText).show(),
g=!0):s.hide(),h.find("div.dg_footer")[g?"show":"hide"]()):(g='<div class="dg_wrapper"><a href="###" class="dg_btn_close">&times;</a><div class="dg_header"'+(a.title?"":' style="display:none"')+">"+a.title+'</div><div class="dg_content">'+a.content+'</div><div class="dg_footer"'+(g?"":' style="display:none"')+'><a href="###" class="dg_btn_no"'+(k?"":' style="display:none"')+">"+a.noText+'</a><a href="###" class="dg_btn_yes"'+(d?"":' style="display:none"')+">"+a.yesText+"</a></div></div>",h=$(g,q),
b.length&&(b.hide(),t.append(b)),e.append(h),p=h.find("a.dg_btn_yes"),s=h.find("a.dg_btn_no"));h.css({width:a.width,height:a.height});if(d)p.on("click.dialog",function(b){!1!==a.yesFn.call(e[0],b)&&f.close(a);b.preventDefault()});k&&(c=function(b){!1!==a.noFn.call(e[0],b)&&f.close(a);this.href&&b.preventDefault()},s.on("click.dialog",c));u=h.find("a.dg_btn_close");a.lock?u.hide():(u.show(),u.on("click.dialog",c))}},resize:function(a){var b=a.data.o;a=m.width()/2;var d=m.height()/2,k={};n&&e[0].style.removeExpression("top");
!b.fixed||n?(k.top=d+m.scrollTop()+"px",k.left=a+m.scrollLeft()+"px"):(k.top=d+"px",k.left=a+"px");(function(){var a=new $.Deferred;b.effects?e.animate(k,function(){a.resolve()}):(e.css(k),a.resolve());return a.promise()})().then(function(){b.overlay&&n&&(c.css({width:"100%",height:"100%"}),c.css({width:f.getDocSize("width")+"px",height:f.getDocSize("height")+"px"}));f.bindExpression(b)})},setPosition:function(a){var b={},d=m.width()/2,k=m.height()/2,g=a.elem||h;!a.fixed||n?(b.position="absolute",
b.top=k+m.scrollTop()+"px",b.left=d+m.scrollLeft()+"px"):(b.position="fixed",b.top=k+"px",b.left=d+"px");b.marginTop="-"+g.outerHeight()/2+"px";b.marginLeft="-"+g.outerWidth()/2+"px";a.top&&(b.top=a.top,b.marginTop="");a.left&&(b.left=a.left,b.marginLeft="");e.css(b)},bindExpression:function(a){n&&a.fixed&&("fixed"!==l.currentStyle.backgroundAttachment&&(l.style.backgroundImage="url(about:blank)",l.style.backgroundAttachment="fixed"),a="fuckIE6=document.documentElement.scrollTop+"+(parseInt(a.top)||
document.documentElement.clientHeight/2)+'+"px"',e[0].style.setExpression("top",a))},bindDrag:function(a){a.drag&&(a=a.dragHandle||e.find("div.dg_header"),a.length&&a.is(":visible")&&(v=new $.ui.Drag(e,{handle:a})))},patterns:function(a,b){var d=e[0].style,k=d.top,g=d.left,c="from",f="to",h="Out",n="fixed"===d.position;e.offset();var d=parseInt(k),p=parseInt(g),q=e.outerWidth(),l=e.outerHeight(),r={},k={opacity:"",width:"",height:"",overflow:"",top:k,left:g};b&&(c="to",f="from",h="In",k.display="none");
switch(a){case "fade":r[c]={opacity:"0",top:d-50+"px"};r[f]={opacity:"1",top:d+"px"};r.duration=200;break;case "slide":g=n?0:m.scrollTop();r[c]={top:g-l/2+"px"};r[f]={top:d+"px"};r.easing="ease"+h+"Strong";break;case "zoom":r[c]={opacity:"0",left:p+q/2+"px",top:d+l/2+"px",width:"0px",height:"0px"},r[f]={opacity:"1",left:p+"px",top:d+"px",width:q+"px",height:l+"px"},r.duration=200,r.easing="ease"+h}return[r,k]},open:function(a){var b=a.effects,d=function(b){return function(){e.css(b);f.bindExpression(a);
f.bindDrag(a);a.elem||p.is(":visible")&&p[0].focus();if(!a.top&&!a.left)m.on("resize.dialog",{o:a},f.resize);a.target.trigger("likeopen")}};b?function(){var b=$.Deferred(),d=c.css("opacity");a.overlay?c.css({visibility:"",opacity:"0"}).animate({opacity:d},200,function(){b.resolve()}):b.resolve();return b.promise()}().then(function(){var a=f.patterns(b,!1),c=a[0];c.complete=d(a[1]);e.css({visibility:"",overflow:"zoom"===b?"hidden":""}).css(c.from).animate(c.to,c.duration,c.easing,c.complete)}):(a.overlay&&
c.css("visibility",""),d({visibility:""})())},close:function(a){var b=a.effects;w&&(clearTimeout(w),w=null);n&&a.fixed&&(e[0].style.removeExpression("top"),l.style.backgroundImage="",l.style.backgroundAttachment="");b?function(){var a=$.Deferred(),c=f.patterns(b,!0),g=c[0];g.complete=function(){e.css(c[1]);a.resolve()};e.css("overflow","zoom"===b?"hidden":"").css(g.from).animate(g.to,g.duration,g.easing,g.complete);return a.promise()}().then(function(){if(a.overlay){var b=c.css("opacity");c.animate({opacity:"0"},
200,function(){c.css({display:"none",opacity:b});a.elem&&a.elem.hide()})}}):(c.hide(),e.hide(),a.elem&&a.elem.hide());v&&(v.destroy(),v=null);h&&(p.off("click.dialog"),s.off("click.dialog"),u.off("click.dialog"));m.off("resize.dialog");y.off("keyup.dialog");a.overlayClose&&c.off("click.dialog");a.target.trigger("likeclose")},init:function(a,b){e&&e.length&&e.is(":visible")&&(c.hide(),e.hide());f.createOverlay(a.zIndex);f.createDialogBox(a.zIndex+1,a.overlay);f.createDialogContent(a);if(a.overlay){c.css({visibility:"hidden",
display:"block"});if(a.overlayClose)c.on("click.dialog",function(){f.close(a)});n&&c.css({width:f.getDocSize("width")+"px",height:f.getDocSize("height")+"px"})}e.css({visibility:"hidden",display:"block"});f.setPosition(a);f.open(a);if(!a.lock)y.on("keyup.dialog",function(b){27===b.which&&f.close(a)});a.autoClose&&(w=setTimeout(function(){f.close(a)},a.autoClose))}},z=function(a,b){a=$(a);b=b||{};if(a.length){var d=$.extend({},A,b);x=d.topWindow?window.top:window;q=x.document;l=q.documentElement;m=
$(x);y=$(q);t=$(q.body);d.elem&&(d.elem=$(d.elem).eq(0),d.elem.length||(d.elem=null));d.dragHandle&&(d.dragHandle=$(d.dragHandle).eq(0),d.dragHandle.length||(d.dragHandle=null));a.on(d.trigger+".dialog",function(){f.init(d)});d.target=a;this.__o__=d}};z.prototype={destroy:function(){if(this.__o__){var a=this.__o__;e.is(":visible")&&this.close();a.elem&&(a.elem.hide(),t.append(a.elem));c.remove();e.remove();c=e=null;a.target.off(a.trigger+".dialog likeopen likeclose");delete this.__o__}},on:function(a,
b){if(this.__o__){var d=this;d.__o__.target.on("like"+a,function(c){c.type=a;c.target=e[0];b.call(d,c);c.stopPropagation()})}return this},un:function(a){this.__o__&&this.__o__.target.off("like"+a);return this},close:function(){this.__o__&&f.close(this.__o__);return this}};$.ui||($.ui={});$.ui.Dialog=z});
